<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<domibus:configuration xmlns:domibus="http://domibus.eu/configuration" party="fi1">
  <mpcs>
    <mpc name="defaultMpc"
         qualifiedName="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/defaultMPC"
         enabled="true"
         default="true"
         retention_downloaded="0"
         retention_undownloaded="14400"/>
  </mpcs>
  <businessProcesses>
    <roles>
      <role name="defaultInitiatorRole" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/initiator"/>
      <role name="defaultResponderRole" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/responder"/>
    </roles>
    <parties>
      <partyIdTypes>
        <partyIdType name="partyTypeUrn" value="urn:oasis:names:tc:ebcore:partyid-type:unregistered"/>
        <partyIdType name="urn:oasis:names:tc:ebcore:partyid-type:EU-LU3" value=""/>
      </partyIdTypes>
      <party name="fi1" endpoint="https://edelivery-ap-fi1:8443/services/msh">
        <identifier partyId="fi1" partyIdType="partyTypeUrn"/>
      </party>
      <party name="fi2" endpoint="https://edelivery-ap-fi2:8443/services/msh">
        <identifier partyId="fi2" partyIdType="partyTypeUrn"/>
      </party>
    </parties>
    <meps>
      <mep name="twoway" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/twoWay"/>
      <binding name="pushAndPush" value="http://docs.oasis-open.org/ebxml-msg/ebms/v3.0/ns/core/200704/pushAndPush"/>
    </meps>
    <properties>
      <property name="originalSenderProperty"
                key="originalSender"
                datatype="string"
                required="true"/>
      <property name="finalRecipientProperty"
                key="finalRecipient"
                datatype="string"
                required="true"/>
      <propertySet name="eDeliveryPropertySet">
        <propertyRef property="finalRecipientProperty"/>
        <propertyRef property="originalSenderProperty"/>
      </propertySet>
    </properties>
    <payloadProfiles>
      <payload name="businessContentPayload"
               cid="cid:message"
               required="true"
               mimeType="text/xml"/>
      <payload name="businessContentAttachment"
               cid="cid:attachment"
               required="false"
               mimeType="application/octet-stream"/>
      <payloadProfile name="MessageProfile" maxSize="40894464">
        <attachment name="businessContentPayload"/>
        <attachment name="businessContentAttachment"/>
      </payloadProfile>
    </payloadProfiles>
    <securities>
      <security name="eDeliveryAS4Policy"
                policy="eDeliveryAS4Policy.xml"
                signatureMethod="RSA_SHA256"/>
    </securities>
    <errorHandlings>
      <errorHandling name="errorHandling"
                     errorAsResponse="true"
                     businessErrorNotifyProducer="true"
                     businessErrorNotifyConsumer="true"
                     deliveryFailureNotifyProducer="true"/>
    </errorHandlings>
    <agreements>
      <agreement name="agreement1" value="A1" type="T1"/>
    </agreements>
    <services>
      <service name="efti-test" value="bdx:noprocess" type="tc1"/>
    </services>
    <actions>
      <action name="efti-gate" value="efti-gate"/>
    </actions>
    <as4>
      <receptionAwareness name="receptionAwareness" retry="12;4;CONSTANT" duplicateDetection="true"/>
      <reliability name="AS4Reliability" nonRepudiation="true" replyPattern="response"/>
    </as4>
    <legConfigurations>
      <legConfiguration name="eftiTestGate"
                        service="efti-test"
                        action="efti-gate"
                        defaultMpc="defaultMpc"
                        reliability="AS4Reliability"
                        security="eDeliveryAS4Policy"
                        receptionAwareness="receptionAwareness"
                        propertySet="eDeliveryPropertySet"
                        payloadProfile="MessageProfile"
                        errorHandling="errorHandling"
                        compressPayloads="true"/>
    </legConfigurations>
    <process name="tc1Process"
             mep="twoway"
             binding="pushAndPush"
             initiatorRole="defaultInitiatorRole"
             responderRole="defaultResponderRole">
      <initiatorParties>
        <initiatorParty name="fi1"/>
        <initiatorParty name="fi2"/>
      </initiatorParties>
      <responderParties>
        <responderParty name="fi1"/>
        <responderParty name="fi2"/>
      </responderParties>
      <legs>
        <leg name="eftiTestGate"/>
      </legs>
    </process>
  </businessProcesses>
</domibus:configuration>